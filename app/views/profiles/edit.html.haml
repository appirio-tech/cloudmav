= content_for :head do
  = javascript_include_tag "http://maps.google.com/maps/api/js?sensor=false"
  = javascript_include_tag "jquery.auto-geocoder"


.grid_16
  %h2 Edit Profile

  = form_for @profile, :url => update_profile_path(@profile) do |f|
    = render :partial => "shared/errors", :locals => { :o => @profile, :o_name => "Profile" }
    .label= f.label :name
    .control= f.text_field :name
    .label= f.label :email
    .control= f.text_field :email
    
    .fieldset.set_location
      %legend Location
      = f.text_area :location, :size=>'20x3', :id=>:location, :class=>:location
      = f.hidden_field :lat, :id => :lat
      = f.hidden_field :lng, :id => :lng
    
    .submit= f.submit "Save", :disable_with => "Saving..."
.clear

:javascript
  $(document).ready(function() {    
    $('#location')
    .bind('auto-geocoder.onGeocodeSuccess', function(e, results, status) {
      $("#lng").val(results[0].geometry.location.lng());
      $("#lat").val(results[0].geometry.location.lat());
    })
    .autoGeocoder();
  });
